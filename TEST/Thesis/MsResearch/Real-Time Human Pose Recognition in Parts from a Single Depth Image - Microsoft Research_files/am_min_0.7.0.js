function LSAM_(w, x, y, t, z, A, B, C, D) { var E = "http://lsam.research.microsoft.com/lg.gif"; var F = "0.7.0"; function AM_(m, n, o, p, q, r, s, t) { this.logOnMouseOver = q; this.logTextSelection = r; this.bindEvents = function () { if (m) sj_be(I, "mousedown", mousedowned); if (o) sj_be(I, "mouseup", mouseupped); if (n) { H = p; sj_be(I, "mousemove", mousemoved) } if (t) { sj_be(J, "resize", resized); sj_be(J, "scroll", scrolled) } }; this.getPos = function (a) { a = sj_ev(a); if (a.pageX || a.pageY) return { x: a.pageX, y: a.pageY }; else return { x: a.clientX + (L.scrollLeft || M == null ? 0 : M.scrollLeft) - (L.clientLeft || 0), y: a.clientY + (L.scrollTop || M == null ? 0 : M.scrollLeft) - (L.clientTop || 0) } }; this.ec = function (a) { return a.toString(36) }; function load() { M = I.body; P.bindEvents(); var a = I.createDocumentFragment(); var i = a.appendChild(document.createElement("img")); i.id = "lg_"; var b = J.screen; i.src = E + "?g=" + Q.g + "&sx=" + P.ec(J.screenX) + "&sy=" + P.ec(J.screenY) + "&bw=" + P.ec(J.outerWidth) + "&bh=" + P.ec(J.outerHeight) + "&aw=" + P.ec(b.availWidth) + "&ah=" + P.ec(b.availHeight) + "&pw=" + P.ec(pageWidth()) + "&ph=" + P.ec(pageHeight()); I.body.appendChild(a); Q.img = i; if (I.cookie) Q.logImmediate("ck=" + I.cookie); logAOI(D); logAllElements() } function logAllElements() { var a = I.getElementsByTagName("*"); var b = a.length; var c = ""; for (var i = 0; i < b; i++) { var d = a[i]; if (d.id == null || d.id == "") { var e = 0; var f = 0; var g = d.parentNode.childNodes; if (g.length > 1) { for (var j = 0; j < g.length; j++) { var h = g[j]; if (h === d) f = e; if (h.nodeType === 1 && h.tagName === d.tagName) e++ } } var k = d.tagName; var l = d.parentNode; do { if (l != null) { k = l.tagName + "/" + k; l = l.parentNode } } while (l != null && l != I); k = "/" + k; if (e > 1) k = k + "[" + f + "]"; d.id = k } c += ",a" + (d.id ? d.id : d.className); c += "|" + P.ec(sj_go(d, "Left")) + "|" + P.ec(sj_go(d, "Top")) + "|" + P.ec(d.offsetWidth) + "|" + P.ec(d.offsetHeight) } Q.logImmediate("b=" + c) } function logAOI(a) { if (a) { var b = AM_.logOnMouseOver; for (var i = 0; i < a.length; i++) { var c = _ge(a[i]); if (c == null && I.getElementsByClassName != null) { c = I.getElementsByClassName(a[i]); if (c.length > 0) c = c[0]; else c = null } logElemPos(c); if (P.logOnMouseOver && c != null) { sj_be(c, "mouseover", mouseoverandout); sj_be(c, "mouseout", mouseoverandout) } } } } function unload() { Q.flushLog("z=1") } sj_be2(J, "load", load); sj_be(J, "beforeunload", unload) } sb_gt = function () { return +new Date }; function LG_() { var b = ""; var d = 1024; var e; this.g = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) { var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8); return v.toString(16) }); this.Log = function (a) { if (b.length + a.length > d) Q.flushLog(); b += a }; this.flushLog = function (a) { if (a != null) this.img.src = E + "?g=" + this.g + "&" + a + "&b=" + b; this.img.src = E + "?g=" + this.g + "&b=" + b; b = "" }; this.logImmediate = function (a) { this.img.src = E + "?g=" + this.g + "&ver=" + F + "&" + a } } function mousedowned(a) { var b = P.getPos(a); Q.Log(",c" + P.ec(b.x) + "|" + P.ec(b.y) + "|" + P.ec(sb_gt() - O)) } function mouseupped(a) { var b = P.getPos(a); var c = J.getSelection; var d = I.selection; var e; Q.Log(",p" + P.ec(b.x) + "|" + P.ec(b.y) + "|" + P.ec(sb_gt() - O)); if (P.logTextSelection) { if (d && d.createRange().text != "") e = d.createRange().getBoundingClientRect(); else if (c && c() != null && c() != "") e = c().getRangeAt(0).getBoundingClientRect();if(e)Q.Log(",t"+P.ec(e.left)+"|"+P.ec(e.top)+"|"+P.ec(e.width)+"|"+P.ec(e.height)+"|"+P.ec(sb_gt()-O))}}var G={x:0,y:0};var H=1;function mousemoved(a){var b=P.getPos(a);if(Math.abs(b.x-G.x)>=H||Math.abs(b.y-G.y)>=H){G=b;Q.Log(",m"+P.ec(b.x)+"|"+P.ec(b.y)+"|"+P.ec(sb_gt()-O))}}function mouseoverandout(a){var b=P.getPos(a);var c=a.target?(a.target.id?a.target.id:a.target.className):null;var t=a.type=="mouseover"?"v":"u";if(c==null&&a.srcElement)c=a.srcElement.id?a.srcElement.id:a.srcElement.className;Q.Log(","+t+c+"|"+P.ec(b.x)+"|"+P.ec(b.y)+"|"+P.ec(sb_gt()-O))}function resized(a){Q.Log(",r"+P.ec(J.outerWidth)+"|"+P.ec(J.outerHeight)+"|"+P.ec(sb_gt()-O))}function scrolled(a){var b=J.pageXOffset||(M==null?0:M.scrollLeft);var c=J.pageYOffset||(M==null?0:M.scrollTop);Q.Log(",s"+P.ec(b)+"|"+P.ec(c)+"|"+P.ec(sb_gt()-O))}function pageWidth(){if(document.documentElement)return document.documentElement.scrollWidth;else return 0}function pageHeight(){if(document.documentElement)return document.documentElement.scrollHeight;else return 0}function logElemPos(a){if(a){var b=",a"+(a.id?a.id:a.className);b+="|"+P.ec(sj_go(a,"Left"))+"|"+P.ec(sj_go(a,"Top"))+"|"+P.ec(a.offsetWidth)+"|"+P.ec(a.offsetHeight);Q.Log(b)}}function sj_ev(n){return K?event:n}function sj_evt(){function i(n){return t[n]||(t[n]=[])}var t={},n=this;n.fire=function(n){for(var r=i(n),u=r.e=arguments,t=0;t<r.length;t++)r[t].d?sb_st(sj_wf(r[t],u),r[t].d):r[t](u)},n.bind=function(n,t,r,u){var f=i(n);t.d=u,f.push(t),r&&f.e&&t(f.e)},n.unbind=function(n,i){for(var u=0,r=t[n];r&&u<r.length;u++)if(r[u]==i){r.splice(u,1);break}}};function _ge(n){return I.getElementById(n)};function sj_go(n,t,i){for(var r=0;n.offsetParent&&n!=(i||M);)r+=n["offset"+t],n=n.offsetParent;return r}function sj_be(n,t,i,r){(n==J||n==I.body)&&t=="load"?sj_evt.bind("onP1",i,1):n.addEventListener?n.addEventListener(t,i,r):n.attachEvent?n.attachEvent("on"+t,i):n["on"+t]=i}function sj_be2(n,t,i,r){n.addEventListener?n.addEventListener(t,i,r):n.attachEvent?n.attachEvent("on"+t,i):n["on"+t]=i}var I=document;var J=window;var K=!!J.ActiveXObject;var L=I.documentElement;var M=I.body;var N=null;var O=sb_gt();var P=new AM_(w,x,y,t,z,A,B,C);var Q=new LG_()}var lsam__=new LSAM_(true,true,true,1,true,true,true,true,null);